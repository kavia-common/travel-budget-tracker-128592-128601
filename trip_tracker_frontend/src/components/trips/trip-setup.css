.tt-trip-setup {
  /* Background fallback via CSS in case the explicit element fails to load */
  position: relative; /* to anchor overlays */
  background-image: url('../../assets/trip-setup-bg.svg');
  background-repeat: no-repeat;
  background-position: center top;
  background-size: cover;

  /* Gentle rounding/shadow already from card, keep readable stacking */
  overflow: hidden;
  isolation: isolate; /* create new stacking context for safe z-index */
}

/* Dedicated background element for stronger visibility and control */
.tt-trip-setup .tt-trip-setup__bg {
  position: absolute;
  inset: 0;
  z-index: -1; /* behind everything within stacking context */
  background-image: url('../../assets/trip-setup-bg.svg');
  background-repeat: no-repeat;
  background-position: center top;
  background-size: cover;

  /* Make the artwork truly present but keep types clear */
  filter: blur(3px) saturate(112%) contrast(102%);
  opacity: 0.95; /* strong presence */
  transform: scale(1.02); /* slight zoom to avoid visible edges after blur */
  pointer-events: none;
}

/* Optional modifier to use the high-quality JPG as the background source.
   NOTE: This rule is intentionally a no-op until the asset is added to src/assets
   to avoid build failures. After copying the photo as src/assets/trip-setup-bg-photo.jpg,
   uncomment the background-image line below. */
/*
.tt-trip-setup.use-photo .tt-trip-setup__bg {
  background-image: url('../../assets/trip-setup-bg-photo.jpg');
}
*/

/* Soft overlay for readability of fields and labels */
.tt-trip-setup::after {
  content: '';
  position: absolute;
  inset: 0;
  z-index: 0;
  /* Light frosted layer: slightly stronger in center, softer at edges */
  background:
    radial-gradient(60% 55% at 50% 28%, rgba(255,255,255,0.72), rgba(255,255,255,0.34) 60%, rgba(255,255,255,0.20) 100%);
  pointer-events: none;
  backdrop-filter: blur(2px) saturate(112%);
}

/* Ensure all content sits above overlays */
.tt-trip-setup > * {
  position: relative;
  z-index: 1;
}

/* Header layering and subtle text legibility boost */
.tt-trip-setup .tt-card__header {
  position: relative;
  z-index: 1;
}

.tt-trip-setup .tt-card__title {
  /* Slight shadow for title over bright bg areas */
  text-shadow: 0 1px 0 rgba(255,255,255,0.5);
}

/* Responsive adjustments */
@media (max-width: 900px) {
  .tt-trip-setup {
    background-position: center top;
    background-size: 140% auto; /* zoom slightly on mobile to keep blobs soft */
  }
  .tt-trip-setup .tt-trip-setup__bg {
    background-position: center top;
    background-size: 170% auto;
    filter: blur(3.5px) saturate(115%) contrast(103%);
    transform: scale(1.04);
  }
  .tt-trip-setup form .grid {
    gap: var(--space-4);
  }
  .tt-trip-setup form .grid[style*="grid-template-columns: '2fr 1fr 1fr'"],
  .tt-trip-setup form .grid[style*="2fr 1fr 1fr"],
  .tt-trip-setup form .grid[style*="1fr auto 1fr"],
  .tt-trip-setup form .grid[style*="2fr 1fr"] {
    grid-template-columns: 1fr !important;
  }
}

/* Slightly increase overlay in dark theme for higher contrast */
[data-theme="dark"] .tt-trip-setup::after {
  background:
    radial-gradient(60% 50% at 50% 30%, rgba(17,24,39,0.36), rgba(17,24,39,0.24) 60%, rgba(17,24,39,0.18) 100%),
    linear-gradient(180deg, rgba(17,24,39,0.12), transparent);
  backdrop-filter: blur(2.2px) saturate(110%);
}

/* Improve form field clarity over background by slightly elevating inputs */
.tt-trip-setup .field input,
.tt-trip-setup .field select,
.tt-trip-setup .field textarea {
  background: color-mix(in srgb, var(--color-surface) 92%, var(--color-primary));
  border-color: color-mix(in srgb, var(--color-border) 88%, var(--color-primary));
  box-shadow: 0 1px 0 rgba(16, 24, 40, 0.02);
}

/* Fallback for browsers without color-mix */
@supports not (background: color-mix(in srgb, white, black)) {
  .tt-trip-setup .field input,
  .tt-trip-setup .field select,
  .tt-trip-setup .field textarea {
    background: rgba(255,255,255,0.94);
    border-color: rgba(31, 43, 46, 0.14);
  }
}

/* Keep switches and tokens readable over the hero */
.tt-trip-setup .switch {
  background: rgba(255,255,255,0.86);
  border-color: var(--color-border);
}

.tt-trip-setup .card {
  background: rgba(255,255,255,0.90);
  border-color: var(--color-border);
}

/* Ensure gradient on Card (with-gradient) remains subtle over the bg */
.tt-trip-setup.with-gradient::before {
  opacity: 0.75;
  z-index: 0; /* still below content */
}
